local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Nettoyage
for _, v in pairs(game:GetService("CoreGui"):GetChildren()) do
    if v:IsA("ScreenGui") and (v.Name:find("Fluent") or v:FindFirstChild("Main")) then
        v:Destroy()
    end
end

local Config = {
    Aimbot = false,
    FOV = 150,
    FlyEnabled = false,
    FlySpeed = 50,
    InfiniteJump = false,
    Tornado = false,
    YeetOnTouch = false,
    Running = true,
    WPCount = 0
}

local FOVCircle = Drawing.new("Circle")
FOVCircle.Thickness = 2
FOVCircle.NumSides = 60
FOVCircle.Color = Color3.fromRGB(255, 0, 0)
FOVCircle.Transparency = 1
FOVCircle.Visible = false

local Window = Fluent:CreateWindow({
    Title = "fait par 2009",
    SubTitle = "virus/bite @ main",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl 
})

local Tabs = {
    Joueur = Window:AddTab({ Title = "Joueur", Icon = "user" }),
    Aimbot = Window:AddTab({ Title = "Aimbot", Icon = "target" }),
    Waypoints = Window:AddTab({ Title = "Waypoints", Icon = "map-pin" }),
    Physique = Window:AddTab({ Title = "Physique", Icon = "activity" }),
    Divers = Window:AddTab({ Title = "Divers", Icon = "plus-circle" })
}

-- --- LOGIQUE DE CIBLE ---
local function getClosest()
    local target, dist = nil, Config.FOV
    local mousePos = UserInputService:GetMouseLocation()
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") and p.Character:FindFirstChild("Humanoid") and p.Character.Humanoid.Health > 0 then
            local pos, onS = Camera:WorldToViewportPoint(p.Character.Head.Position)
            if onS then
                local mag = (Vector2.new(pos.X, pos.Y) - mousePos).Magnitude
                if mag < dist then target = p dist = mag end
            end
        end
    end
    return target
end

-- --- REDIRECTION DES TIRS (POUR LES DÉGÂTS) ---
local oldNamecall
oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
    local method = getnamecallmethod()
    local args = {...}
    
    if Config.Aimbot and (method == "FindPartOnRayWithIgnoreList" or method == "Raycast") then
        local t = getClosest()
        if t and t.Character and t.Character:FindFirstChild("Head") then
            if method == "Raycast" then
                args[2] = (t.Character.Head.Position - args[1]).Unit * 5000
            else
                args[1] = Ray.new(args[1].Origin, (t.Character.Head.Position - args[1].Origin).Unit * 5000)
            end
            return oldNamecall(self, unpack(args))
        end
    end
    return oldNamecall(self, ...)
end)

-- --- INTERFACE ---
Tabs.Aimbot:AddToggle("AimActive", {Title = "Activer Dégâts Aimbot", Default = false}):OnChanged(function(v) Config.Aimbot = v end)
Tabs.Aimbot:AddSlider("AimFOV", {Title = "Taille du Cercle", Default = 150, Min = 30, Max = 800, Rounding = 0, Callback = function(v) Config.FOV = v end})

Tabs.Joueur:AddSlider("Vitesse", {Title = "Vitesse", Default = 16, Min = 16, Max = 250, Rounding = 0, Callback = function(v) if LocalPlayer.Character then LocalPlayer.Character.Humanoid.WalkSpeed = v end end})
Tabs.Physique:AddToggle("FlyCheck", {Title = "Activer Fly", Default = false}):OnChanged(function(v) Config.FlyEnabled = v end)

-- --- BOUCLE PRINCIPALE ---
RunService.RenderStepped:Connect(function()
    if not Config.Running then return end
    
    FOVCircle.Visible = Config.Aimbot
    FOVCircle.Radius = Config.FOV
    FOVCircle.Position = UserInputService:GetMouseLocation()

    if Config.Aimbot and UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
        local t = getClosest()
        if t then Camera.CFrame = CFrame.lookAt(Camera.CFrame.Position, t.Character.Head.Position) end
    end

    -- Fly / Physique
    local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if root and Config.FlyEnabled then
        root.Velocity = Vector3.new(0, 2, 0) -- Stabilisation simple
    end
end)

Tabs.Divers:AddButton({Title = "❌ FERMER", Callback = function() Config.Running = false FOVCircle:Remove() Window:Destroy() end})
Window:SelectTab(1)
